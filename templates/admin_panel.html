<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>MASTER AXSHU PANEL</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>
  <div class="container py-5">
    <h2 class="text-center text-info mb-4">MASTER AXSHU PANEL</h2>

    <ul class="nav nav-tabs mb-3" id="myTab" role="tablist">
      <li class="nav-item"><button class="nav-link active" data-bs-toggle="tab" data-bs-target="#sessions">ğŸ“‚ Sessions</button></li>
      <li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#logs">ğŸ“œ Logs</button></li>
    </ul>

    <div class="tab-content">
      <div class="tab-pane fade show active" id="sessions">
        <div class="table-responsive">
          <table class="table table-dark table-striped table-bordered align-middle text-center">
            <thead class="table-light text-dark">
              <tr>
                <th>Index</th><th>Thread ID</th><th>Prefix</th><th>Interval</th><th>Tokens</th><th>Messages</th><th>Action</th>
              </tr>
            </thead>
            <tbody>
              {% for idx, user in users %}
              <tr>
                <td>{{ idx }}</td>
                <td>{{ user.thread_id }}</td>
                <td>{{ user.prefix }}</td>
                <td>{{ user.interval }}</td>
                <td>{{ user.tokens|length }}</td>
                <td>{{ user.messages|length }}</td>
                <td>
                  <form method="POST" action="/admin/remove/{{ idx }}">
                    <button type="submit" class="btn btn-sm btn-danger">âŒ Remove</button>
                  </form>
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>

      <div class="tab-pane fade" id="logs">
        <div class="bg-black p-3 rounded" style="height:400px; overflow-y:scroll;">
          <pre id="log-box" class="text-success">{{ logs }}</pre>
        </div>
      </div>
    </div>

    <div class="text-center mt-3">
      <a href="/admin/logout" class="btn btn-warning">ğŸ”’ Logout</a>
    </div>
  </div>

  <script>
    setInterval(function(){
      fetch('/admin/logs')
        .then(res => res.text())
        .then(data => { document.getElementById('log-box').innerText = data; });
    }, 3000);
  </script>
</body>
</html>
